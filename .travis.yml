env:
  - GHCVER=7.6.3
  - GHCVER=7.8.3
  - GHCVER=head
env:
  global:
    secure: rRwJ4hbIrQHOB7dnk/rEvbI9ybyzkTKv4ycAc17f2GsXNM6s/l8piZa85o38qxkfopzU50JVLB4/QnaURH/cJoE4oR0GdPDiwMPeDHdPkiKX8RHjdj0kfBvguWckEM0PWumreD0ZU+prieGfY23tjoo4TsJk+e5HgeD1RfuzTa8=
deploy:
  provider: hackage
  username: HiromiIshii
  password:
    secure: LN7bRSP8bsF/Y37L+MIQz4VkssAT0zgNhkToUYD18pkNBily/tdXKiTM+0JAJ/8QkGPMdz1XW+pjo44Wbe/HBGnowsu3kYkiUPxbBegASvmR5Il1qwtUKYO/wkNMNBu/dSzhEIZHvRfsc0PDv+7Akc5g3Qn5PNvmAND3p+scjug=
  on:
    all_branches: true
    tags: true
before_install:
- travis_retry sudo add-apt-repository -y ppa:hvr/ghc
- travis_retry sudo apt-get update
- echo "ghc == $GHCVER"
- travis_retry sudo apt-get install cabal-install-1.18 ghc-$GHCVER happy
- export PATH=/opt/ghc/$GHCVER/bin:$PATH
install:
- cabal-1.18 update
- cabal-1.18 install --only-dependencies --enable-tests --enable-benchmarks
script:
- cabal-1.18 configure --enable-tests --enable-benchmarks -v2
- cabal-1.18 build
- cabal-1.18 test
- cabal-1.18 check
- cabal-1.18 sdist
- export SRC_TGZ=$(cabal-1.18 info . | awk '{print $2 ".tar.gz";exit}') ; cd dist/;
  if [ -f "$SRC_TGZ" ]; then cabal-1.18 install "$SRC_TGZ"; else echo "expected '$SRC_TGZ'
  not found"; exit 1; fi
matrix:
  allow_failures:
  - env: GHCVER=head
